syzkaller login: [   17.328267] ==================================================================
[   17.328770] BUG: KCSAN: data-race in generic_write_end / mpage_submit_folio
[   17.329330] 
[   17.329451] write to 0xffff894244e44ef8 of 8 bytes by task 335 on cpu 0:
[   17.329909]  generic_write_end+0x9d/0x200
[   17.330242]  ext4_da_write_end+0xfb/0x600
[   17.330548]  generic_perform_write+0x205/0x360
[   17.330853]  ext4_buffered_write_iter+0xa9/0x1c0
[   17.331233]  ext4_file_write_iter+0xcd/0xdd0
[   17.331597]  vfs_write+0x5d0/0x700
[   17.331844]  ksys_write+0x9e/0x160
[   17.332089]  __x64_sys_write+0x41/0x50
[   17.332398]  do_syscall_64+0x3e/0x90
[   17.332664]  entry_SYSCALL_64_after_hwframe+0x6e/0xd8
[   17.333022] 
[   17.333142] read to 0xffff894244e44ef8 of 8 bytes by task 31 on cpu 1:
[   17.333643]  mpage_submit_folio+0x58/0x130
[   17.333923]  mpage_map_and_submit_buffers+0x31c/0x5a0
[   17.334259]  ext4_do_writepages+0xcd5/0x1830
[   17.334558]  ext4_writepages+0x19c/0x320
[   17.334897]  do_writepages+0xb5/0x2e0
[   17.335206]  __writeback_single_inode+0x72/0x650
[   17.335522]  writeback_sb_inodes+0x463/0x930
[   17.335817]  __writeback_inodes_wb+0x72/0x160
[   17.336169]  wb_writeback+0x211/0x4e0
[   17.336452]  wb_workfn+0x5df/0x8e0
[   17.336698]  process_one_work+0x545/0x9c0
[   17.336976]  worker_thread+0x33d/0x8d0
[   17.337333]  kthread+0x1b1/0x200
[   17.337575]  ret_from_fork+0x2f/0x50
[   17.337825]  ret_from_fork_asm+0x1b/0x30
[   17.338189] 
[   17.338305] value changed: 0x0000000000cb5000 -> 0x0000000000cb7000
[   17.338698] 
[   17.338814] Reported by Kernel Concurrency Sanitizer on:
[   17.339200] CPU: 1 PID: 31 Comm: kworker/u4:2 Not tainted 6.5.0 #8
[   17.339598] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   17.340105] Workqueue: writeback wb_workfn (flush-8:0)
[   17.340521] ==================================================================

VM DIAGNOSIS:
09:01:01  Registers:
info registers vcpu 0
RAX=0000000000000000 RBX=0000000000051082 RCX=ffffffffb61a0fb3 RDX=ffff894240926600
RSI=0000000000000000 RDI=ffff8d1240693c30 RBP=ffff8942461a04d0 RSP=ffff8d1240693bf0
R8 =ffffffffb96c4370 R9 =0000000000000000 R10=ffffffffb61a0f93 R11=0001ffffffffffff
R12=0000000000000000 R13=0000000000000001 R14=ffff894240926600 R15=0000000000000001
RIP=ffffffffb61a0fb6 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fb161dd38c0 00000000 00000000
GS =0000 ffff894377c00000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe4301492000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe4301490000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007fff37c57a28 CR3=00000001003de004 CR4=00770ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00009fc0
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 ff000000000000ff 0000000000000000
YMM01=0000000000000000 0000000000000000 2525252525252525 2525252525252525
YMM02=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM03=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM04=0000000000000000 0000000000000000 00000000000000ff 0000000000000000
YMM05=0000000000000000 0000000000000000 2fccd54c36d8a3f3 00000000001b2b30
YMM06=0000000000000000 0000000000000000 5e5c10884646930b 00000000001b1fd8
YMM07=0000000000000000 0000000000000000 693bd129e125714a 00000000001b0bd8
YMM08=0000000000000000 0000000000000000 a0981fdad8d424be 00000000001d8120
YMM09=0000000000000000 0000000000000000 ffff00ffffff0000 0000ffffff00ffff
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1
RAX=ffff894243e69be8 RBX=0000000000000002 RCX=000189424622e510 RDX=0000000000000ad5
RSI=0001ffffffffffff RDI=ffff89424622e510 RBP=ffff89424622e500 RSP=ffff8d124076b5a8
R8 =ffffffffb96c4448 R9 =0000000000000000 R10=ffffffffb7809e73 R11=0001ffffffffffff
R12=ffff894243222310 R13=0000000000000000 R14=ffff8d124076b718 R15=ffff8d124076b9e8
RIP=ffffffffb7809e77 RFL=00000202 [-------] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f9ffe70e8c0 00000000 00000000
GS =0000 ffff894377d00000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe16a1db0000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe16a1dae000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f9ff98de0b8 CR3=0000000108a2c006 CR4=00770ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 2e322e302e30313d 656d616e74736f68
YMM02=0000000000000000 0000000000000000 2022646873732f6e 6962732f7273752f
YMM03=0000000000000000 0000000000000000 223d657865202274 6f6f72223d746363
YMM04=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM05=0000000000000000 0000000000000000 5a5a5a5a5a5a5a5a 5a5a5a5a5a5a5a5a
YMM06=0000000000000000 0000000000000000 2020202020202020 2020202020202020
YMM07=0000000000000000 0000000000000000 0000ff000000ffff 0000000000ffffff
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000202020
YMM09=0000000000000000 0000000000000000 ff0000ffffffffff ff00000000ffffff
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0f4790056c4bc3fd 830d52ed55a010c3
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
