syzkaller login: [   17.447871] ==================================================================
[   17.448480] BUG: KCSAN: data-race in generic_write_end / mpage_submit_folio
[   17.449049] 
[   17.449173] write to 0xffff9ad94462fbf8 of 8 bytes by task 335 on cpu 0:
[   17.449613]  generic_write_end+0x9d/0x200
[   17.449908]  ext4_da_write_end+0xfb/0x600
[   17.450340]  generic_perform_write+0x205/0x360
[   17.450666]  ext4_buffered_write_iter+0xa9/0x1c0
[   17.450997]  ext4_file_write_iter+0xcd/0xdd0
[   17.451403]  vfs_write+0x5d0/0x700
[   17.451656]  ksys_write+0x9e/0x160
[   17.451910]  __x64_sys_write+0x41/0x50
[   17.452268]  do_syscall_64+0x3e/0x90
[   17.452563]  entry_SYSCALL_64_after_hwframe+0x6e/0xd8
[   17.452923] 
[   17.453065] read to 0xffff9ad94462fbf8 of 8 bytes by task 31 on cpu 1:
[   17.453626]  mpage_submit_folio+0x58/0x130
[   17.453916]  mpage_map_and_submit_buffers+0x31c/0x5a0
[   17.454267]  ext4_do_writepages+0xcd5/0x1830
[   17.454664]  ext4_writepages+0x19c/0x320
[   17.455125]  do_writepages+0xb5/0x2e0
[   17.455406]  __writeback_single_inode+0x72/0x650
[   17.455735]  writeback_sb_inodes+0x463/0x930
[   17.456084]  __writeback_inodes_wb+0x72/0x160
[   17.456397]  wb_writeback+0x211/0x4e0
[   17.456666]  wb_workfn+0x5df/0x8e0
[   17.457020]  process_one_work+0x545/0x9c0
[   17.457307]  worker_thread+0x33d/0x8d0
[   17.457594]  kthread+0x1b1/0x200
[   17.457844]  ret_from_fork+0x2f/0x50
[   17.458104]  ret_from_fork_asm+0x1b/0x30
[   17.458390] 
[   17.458571] value changed: 0x000000000171e000 -> 0x0000000001720000
[   17.459126] 
[   17.459247] Reported by Kernel Concurrency Sanitizer on:
[   17.459593] CPU: 1 PID: 31 Comm: kworker/u4:2 Not tainted 6.5.0 #8
[   17.460120] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   17.460653] Workqueue: writeback wb_workfn (flush-8:0)
[   17.461181] ==================================================================

VM DIAGNOSIS:
10:19:45  Registers:
info registers vcpu 0
RAX=0000000000000000 RBX=0000000000000000 RCX=ffffffff980515b4 RDX=0000000000000005
RSI=ffffffff988c1c84 RDI=000000000000b91c RBP=ffffffff98c0c900 RSP=ffffffff98c03e68
R8 =ffffffff99ec4410 R9 =0000000000000000 R10=0000000000000005 R11=0001ffffffffffff
R12=0000000000000000 R13=0000000000000000 R14=0000000000000000 R15=0000000000000000
RIP=ffffffff980524bf RFL=00000216 [----AP-] CPL=0 II=0 A20=1 SMM=0 HLT=1
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff9ada77c00000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe3d1ffe5000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe3d1ffe3000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f3e6f1bd000 CR3=00000001003d8006 CR4=00770ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00009fc0
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 52b2193b902aa6dd 0000000000162650
YMM01=0000000000000000 0000000000000000 405444f11b13cef7 00000000001d9530
YMM02=0000000000000000 0000000000000000 eff9b2d0a8fce9cb 00000000001ce628
YMM03=0000000000000000 0000000000000000 ec2efd57dc4c00df 00000000001ce6e0
YMM04=0000000000000000 0000000000000000 1d17d1e0dabc12db 00000000001d9420
YMM05=0000000000000000 0000000000000000 935310ac64d92d63 00000000001ce7b0
YMM06=0000000000000000 0000000000000000 e042d86d42eb936e 00000000001d1c28
YMM07=0000000000000000 0000000000000000 58f17c1affdc82d6 00000000001d1d58
YMM08=0000000000000000 0000000000000000 405444f11b13cef7 00000000001d9530
YMM09=0000000000000000 0000000000000000 ffff00ffffff0000 0000ffffff00ffff
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1
RAX=0000000080000001 RBX=ffff9ad9432b8a80 RCX=ffffffff969aa08d RDX=ffff9ad9431ac400
RSI=0000000080000001 RDI=ffff9ad942b74cb0 RBP=00007f7838796000 RSP=ffffac48007f3b00
R8 =ffffffff99ec4478 R9 =0000000000000000 R10=0000000000000004 R11=0001ffffffffffff
R12=0000000000000000 R13=00007f7838797000 R14=00007f7838689000 R15=ffff9ad942b74cb0
RIP=ffffffff96872721 RFL=00000246 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff9ada77d00000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe78e4d05000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe78e4d03000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f78367fa0e1 CR3=0000000100184005 CR4=00770ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 2e322e302e30313d 656d616e74736f68
YMM02=0000000000000000 0000000000000000 2022646873732f6e 6962732f7273752f
YMM03=0000000000000000 0000000000000000 223d657865202274 6f6f72223d746363
YMM04=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM05=0000000000000000 0000000000000000 5a5a5a5a5a5a5a5a 5a5a5a5a5a5a5a5a
YMM06=0000000000000000 0000000000000000 2020202020202020 2020202020202020
YMM07=0000000000000000 0000000000000000 0000ffff00ff00ff 0000000000ffffff
YMM08=0000000000000000 0000000000000000 0000000000200000 0000000000202020
YMM09=0000000000000000 0000000000000000 ff0000ffffffffff ff00000000ffffff
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0f4790056c4bc3fd 830d52ed55a010c3
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
