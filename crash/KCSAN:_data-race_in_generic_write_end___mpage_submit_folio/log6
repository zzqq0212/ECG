syzkaller login: [   17.323351] ==================================================================
[   17.323991] BUG: KCSAN: data-race in generic_write_end / mpage_submit_folio
[   17.324560] 
[   17.324706] write to 0xffff90b64428e0f8 of 8 bytes by task 335 on cpu 0:
[   17.325137]  generic_write_end+0x9d/0x200
[   17.325567]  ext4_da_write_end+0xfb/0x600
[   17.325854]  generic_perform_write+0x205/0x360
[   17.326266]  ext4_buffered_write_iter+0xa9/0x1c0
[   17.326590]  ext4_file_write_iter+0xcd/0xdd0
[   17.326895]  vfs_write+0x5d0/0x700
[   17.327232]  ksys_write+0x9e/0x160
[   17.327512]  __x64_sys_write+0x41/0x50
[   17.327788]  do_syscall_64+0x3e/0x90
[   17.328093]  entry_SYSCALL_64_after_hwframe+0x6e/0xd8
[   17.328502] 
[   17.328638] read to 0xffff90b64428e0f8 of 8 bytes by task 97 on cpu 1:
[   17.329062]  mpage_submit_folio+0x58/0x130
[   17.329363]  mpage_map_and_submit_buffers+0x31c/0x5a0
[   17.329711]  ext4_do_writepages+0xcd5/0x1830
[   17.330081]  ext4_writepages+0x19c/0x320
[   17.330462]  do_writepages+0xb5/0x2e0
[   17.330771]  __writeback_single_inode+0x72/0x650
[   17.331173]  writeback_sb_inodes+0x463/0x930
[   17.331507]  __writeback_inodes_wb+0x72/0x160
[   17.331829]  wb_writeback+0x211/0x4e0
[   17.332139]  wb_workfn+0x5df/0x8e0
[   17.332390]  process_one_work+0x545/0x9c0
[   17.332760]  worker_thread+0x33d/0x8d0
[   17.333042]  kthread+0x1b1/0x200
[   17.333285]  ret_from_fork+0x2f/0x50
[   17.333534]  ret_from_fork_asm+0x1b/0x30
[   17.333821] 
[   17.334028] value changed: 0x0000000000c94000 -> 0x0000000000c97000
[   17.334436] 
[   17.334554] Reported by Kernel Concurrency Sanitizer on:
[   17.334892] CPU: 1 PID: 97 Comm: kworker/u4:3 Not tainted 6.5.0 #8
[   17.335396] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   17.336025] Workqueue: writeback wb_workfn (flush-8:0)
[   17.336401] ==================================================================
[   17.599919] ==================================================================
[   17.600419] BUG: KCSAN: data-race in generic_write_end / mpage_process_page_bufs
[   17.600904] 
[   17.601027] write to 0xffff90b64428e0f8 of 8 bytes by task 335 on cpu 1:
[   17.601520]  generic_write_end+0x9d/0x200
[   17.601819]  ext4_da_write_end+0xfb/0x600
[   17.602113]  generic_perform_write+0x205/0x360
[   17.602431]  ext4_buffered_write_iter+0xa9/0x1c0
[   17.602760]  ext4_file_write_iter+0xcd/0xdd0
[   17.603067]  vfs_write+0x5d0/0x700
[   17.603322]  ksys_write+0x9e/0x160
[   17.603594]  __x64_sys_write+0x41/0x50
[   17.603876]  do_syscall_64+0x3e/0x90
[   17.604143]  entry_SYSCALL_64_after_hwframe+0x6e/0xd8
[   17.604489] 
[   17.604610] read to 0xffff90b64428e0f8 of 8 bytes by task 97 on cpu 0:
[   17.605059]  mpage_process_page_bufs+0x33/0x3f0
[   17.605379]  mpage_prepare_extent_to_map+0x79a/0x9d0
[   17.605733]  ext4_do_writepages+0x80d/0x1830
[   17.606044]  ext4_writepages+0x19c/0x320
[   17.606334]  do_writepages+0xb5/0x2e0
[   17.606615]  __writeback_single_inode+0x72/0x650
[   17.606946]  writeback_sb_inodes+0x463/0x930
[   17.607251]  __writeback_inodes_wb+0x72/0x160
[   17.607590]  wb_writeback+0x211/0x4e0
[   17.607861]  wb_workfn+0x5df/0x8e0
[   17.608117]  process_one_work+0x545/0x9c0
[   17.608410]  worker_thread+0x33d/0x8d0
[   17.608682]  kthread+0x1b1/0x200
[   17.608934]  ret_from_fork+0x2f/0x50
[   17.609195]  ret_from_fork_asm+0x1b/0x30
[   17.609482] 
[   17.609604] value changed: 0x0000000001a38000 -> 0x0000000001a3a000
[   17.610014] 
[   17.610135] Reported by Kernel Concurrency Sanitizer on:
[   17.610483] CPU: 0 PID: 97 Comm: kworker/u4:3 Not tainted 6.5.0 #8
[   17.610898] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   17.611433] Workqueue: writeback wb_workfn (flush-8:0)
[   17.611861] ==================================================================
[   17.626335] scp (335) used greatest stack depth: 11896 bytes left

VM DIAGNOSIS:
08:41:38  Registers:
info registers vcpu 0
RAX=0000000000000000 RBX=0000000aab5ef796 RCX=0000000000000000 RDX=0000000000000000
RSI=ffffffff914c1c84 RDI=ffffffff914d3d9c RBP=0000000aab5e46d2 RSP=ffffa0e800727838
R8 =0000000000000002 R9 =000590b64273ea02 R10=0000000000000000 R11=000000000000003e
R12=0000000000000000 R13=000000000000bf69 R14=ffffffff908aaa31 R15=0000000000000286
RIP=ffffffff90c46c04 RFL=00000046 [---Z-P-] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007fa192bd7700 00000000 00000000
GS =0000 ffff90b777c00000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe485f95d000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe485f95b000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f0b5c28b370 CR3=000000010444a001 CR4=00770ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 203a31313a363132 39332074726f7020
YMM01=0000000000000000 0000000000000000 322e322e302e3031 206d6f7266207463
YMM02=0000000000000000 0000000000000000 656e6e6f63736964 2064657669656365
YMM03=0000000000000000 0000000000000000 52203a5d3633335b 646873732038333a
YMM04=0000000000000000 0000000000000000 ffffffffffffff00 ffff0000ff000000
YMM05=0000000000000000 0000000000000000 656e6f6e2e6e6f6d 6561642c6e6f7263
YMM06=0000000000000000 0000000000000000 3b656e6f6e2e7669 7270687475612c68
YMM07=0000000000000000 0000000000000000 7475613b6e726177 3d2e2a3b65636974
YMM08=0000000000000000 0000000000000000 0000000000000020 0000000000002000
YMM09=0000000000000000 0000000000000000 0000ffffffffffff ffffffffffffff00
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1
RAX=00000000fffffffd RBX=0000000000000000 RCX=0001a0e800617be8 RDX=0000000000000aaa
RSI=0001ffffffffffff RDI=ffffa0e800617be8 RBP=00007f6bdb044000 RSP=ffffa0e800617b08
R8 =ffffffff92ac4390 R9 =0000000000000000 R10=ffffffff8f5aa3d4 R11=0001ffffffffffff
R12=ffffe0da844e0680 R13=00007f6bdb045000 R14=ffffe0da844e0688 R15=ffff90b644466220
RIP=ffffffff8f5aa3e3 RFL=00000282 [--S----] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff90b777d00000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe0dd2633000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe0dd2631000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f6bd8b740e1 CR3=00000001054fa004 CR4=00770ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 2e322e302e30313d 656d616e74736f68
YMM02=0000000000000000 0000000000000000 2022646873732f6e 6962732f7273752f
YMM03=0000000000000000 0000000000000000 223d657865202274 6f6f72223d746363
YMM04=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM05=0000000000000000 0000000000000000 5a5a5a5a5a5a5a5a 5a5a5a5a5a5a5a5a
YMM06=0000000000000000 0000000000000000 2020202020202020 2020202020202020
YMM07=0000000000000000 0000000000000000 0000ffff00ff00ff 0000000000ffffff
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000202020
YMM09=0000000000000000 0000000000000000 ff0000ffffffffff ff00000000ffffff
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0f4790056c4bc3fd 830d52ed55a010c3
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
