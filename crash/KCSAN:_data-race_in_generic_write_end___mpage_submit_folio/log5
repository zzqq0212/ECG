syzkaller login: [   17.361456] ==================================================================
[   17.361950] BUG: KCSAN: data-race in generic_write_end / mpage_submit_folio
[   17.362408] 
[   17.362527] write to 0xffff9309042845f8 of 8 bytes by task 344 on cpu 1:
[   17.362981]  generic_write_end+0x9d/0x200
[   17.363269]  ext4_da_write_end+0xfb/0x600
[   17.363552]  generic_perform_write+0x205/0x360
[   17.363860]  ext4_buffered_write_iter+0xa9/0x1c0
[   17.364174]  ext4_file_write_iter+0xcd/0xdd0
[   17.364471]  vfs_write+0x5d0/0x700
[   17.364714]  ksys_write+0x9e/0x160
[   17.364983]  __x64_sys_write+0x41/0x50
[   17.365248]  do_syscall_64+0x3e/0x90
[   17.365513]  entry_SYSCALL_64_after_hwframe+0x6e/0xd8
[   17.365857] 
[   17.365975] read to 0xffff9309042845f8 of 8 bytes by task 31 on cpu 0:
[   17.366385]  mpage_submit_folio+0x58/0x130
[   17.366663]  mpage_map_and_submit_buffers+0x31c/0x5a0
[   17.366997]  ext4_do_writepages+0xcd5/0x1830
[   17.367296]  ext4_writepages+0x19c/0x320
[   17.367574]  do_writepages+0xb5/0x2e0
[   17.367846]  __writeback_single_inode+0x72/0x650
[   17.368159]  writeback_sb_inodes+0x463/0x930
[   17.368455]  __writeback_inodes_wb+0x72/0x160
[   17.368753]  wb_writeback+0x211/0x4e0
[   17.369032]  wb_workfn+0x5df/0x8e0
[   17.369276]  process_one_work+0x545/0x9c0
[   17.369548]  worker_thread+0x33d/0x8d0
[   17.369808]  kthread+0x1b1/0x200
[   17.370049]  ret_from_fork+0x2f/0x50
[   17.370298]  ret_from_fork_asm+0x1b/0x30
[   17.370574] 
[   17.370692] value changed: 0x000000000136f000 -> 0x0000000001370000
[   17.371084] 
[   17.371199] Reported by Kernel Concurrency Sanitizer on:
[   17.371529] CPU: 0 PID: 31 Comm: kworker/u4:2 Not tainted 6.5.0 #8
[   17.371925] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[   17.372431] Workqueue: writeback wb_workfn (flush-8:0)
[   17.372830] ==================================================================
[   17.529476] scp (344) used greatest stack depth: 11664 bytes left

VM DIAGNOSIS:
08:07:34  Registers:
info registers vcpu 0
RAX=000000000000001b RBX=000000000000000a RCX=0000000000000000 RDX=0000000000000005
RSI=00007ffc5c2d65d7 RDI=00007f85052d545b RBP=00007ffc5c2d65d7 RSP=00007ffc5c2d6538
R8 =000000000000ffff R9 =0000000000000000 R10=00007f85048db430 R11=00007f850491b2e0
R12=000000000000000c R13=00007f85053b5ec0 R14=00007ffc5c2d65d6 R15=0000000000000073
RIP=00007f85048db7b8 RFL=00000283 [--S---C] CPL=3 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0033 0000000000000000 ffffffff 00a0fb00 DPL=3 CS64 [-RA]
SS =002b 0000000000000000 ffffffff 00c0f300 DPL=3 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 00007f85055d08c0 00000000 00000000
GS =0000 0000000000000000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe1a24056000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe1a24054000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007ffc48b7fa38 CR3=00000001003da002 CR4=00770ef0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00009fc0
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 00ff000000000000 0000ff0000000000
YMM01=0000000000000000 0000000000000000 0001000000000000 000000ffffffffff
YMM02=0000000000000000 0000000000000000 007ffc5c2d6a0000 007f006563696c73
YMM03=0000000000000000 0000000000000000 ffff00ff00000000 0000000000000000
YMM04=0000000000000000 0000000000000000 ffff00ff00000000 0000000000000000
YMM05=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM06=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM07=0000000000000000 0000000000000000 80f09f19808d26a3 0000000000162930
YMM08=0000000000000000 0000000000000000 ea50d7801ba4fb64 00000000001d8a48
YMM09=0000000000000000 0000000000000000 ffff00ffffff0000 0000ffffff00ffff
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
info registers vcpu 1
RAX=0000000000000000 RBX=ffffdd9907039f88 RCX=ffffffff833aa36e RDX=ffff93090200c400
RSI=0000000000000000 RDI=ffffdd99040b9d08 RBP=00007f01d4de1000 RSP=ffffb5df008b7b00
R8 =ffffffff868c44a0 R9 =0000000000000000 R10=0000000000000004 R11=0001ffffffffffff
R12=ffffdd99040b9d00 R13=00007f01d4de2000 R14=ffffdd99040b9d08 R15=ffff930902300f08
RIP=ffffffff83272710 RFL=00000293 [--S-A-C] CPL=0 II=0 A20=1 SMM=0 HLT=0
ES =0000 0000000000000000 00000000 00000000
CS =0010 0000000000000000 ffffffff 00a09b00 DPL=0 CS64 [-RA]
SS =0018 0000000000000000 ffffffff 00c09300 DPL=0 DS   [-WA]
DS =0000 0000000000000000 00000000 00000000
FS =0000 0000000000000000 00000000 00000000
GS =0000 ffff930a37d00000 00000000 00000000
LDT=0000 0000000000000000 00000000 00000000
TR =0040 fffffe6dc937e000 00004087 00008b00 DPL=0 TSS64-busy
GDT=     fffffe6dc937c000 0000007f
IDT=     fffffe0000000000 00000fff
CR0=80050033 CR2=00007f01d39a60e1 CR3=000000010018c006 CR4=00770ee0
DR0=0000000000000000 DR1=0000000000000000 DR2=0000000000000000 DR3=0000000000000000 
DR6=00000000ffff0ff0 DR7=0000000000000400
EFER=0000000000000d01
FCW=037f FSW=0000 [ST=0] FTW=00 MXCSR=00001f80
FPR0=0000000000000000 0000 FPR1=0000000000000000 0000
FPR2=0000000000000000 0000 FPR3=0000000000000000 0000
FPR4=0000000000000000 0000 FPR5=0000000000000000 0000
FPR6=0000000000000000 0000 FPR7=0000000000000000 0000
YMM00=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM01=0000000000000000 0000000000000000 2e322e302e30313d 656d616e74736f68
YMM02=0000000000000000 0000000000000000 2022646873732f6e 6962732f7273752f
YMM03=0000000000000000 0000000000000000 223d657865202274 6f6f72223d746363
YMM04=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM05=0000000000000000 0000000000000000 5a5a5a5a5a5a5a5a 5a5a5a5a5a5a5a5a
YMM06=0000000000000000 0000000000000000 2020202020202020 2020202020202020
YMM07=0000000000000000 0000000000000000 0000ff0000ff00ff 0000000000ffffff
YMM08=0000000000000000 0000000000000000 0000000000000000 0000000000202020
YMM09=0000000000000000 0000000000000000 ff0000ffffffffff ff00000000ffffff
YMM10=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM11=0000000000000000 0000000000000000 0f4790056c4bc3fd 830d52ed55a010c3
YMM12=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM13=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM14=0000000000000000 0000000000000000 0000000000000000 0000000000000000
YMM15=0000000000000000 0000000000000000 0000000000000000 0000000000000000
